import{j as e}from"./jsx-runtime.DeqwNDbN.js";import{r as n}from"./index.DbYiSJ-C.js";import{s as y}from"./supabase.kJRL6j1B.js";import{z as h,y as f}from"./dialog.Cigdy6Vf.js";import"./index.DTt_QiUe.js";function w({isOpen:u,onClose:l,onCategoryAdded:d}){const[a,o]=n.useState({name:"",description:""}),[g,c]=n.useState(!1),r=async i=>{i.preventDefault(),c(!0);try{const{data:m,error:p}=await y.from("categories").insert([{name:a.name,description:a.description}]).select().single();if(p)throw p;d(m),o({name:"",description:""}),l()}catch(m){console.error("Error adding category:",m),alert("Error al agregar la categoría")}finally{c(!1)}};return e.jsx(h.Root,{show:u,as:n.Fragment,children:e.jsxs(f,{as:"div",className:"relative z-10",onClose:l,children:[e.jsx(h.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"})}),e.jsx("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:e.jsx(h.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:e.jsx(f.Panel,{className:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6",children:e.jsxs("form",{onSubmit:r,children:[e.jsx("div",{children:e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:text-left",children:[e.jsx(f.Title,{as:"h3",className:"text-base font-semibold leading-6 text-gray-900",children:"Agregar Nueva Categoría"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium leading-6 text-gray-900",children:"Nombre"}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{type:"text",name:"name",id:"name",required:!0,value:a.name,onChange:i=>o({...a,name:i.target.value}),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium leading-6 text-gray-900",children:"Descripción"}),e.jsx("div",{className:"mt-2",children:e.jsx("textarea",{name:"description",id:"description",rows:3,value:a.description,onChange:i=>o({...a,description:i.target.value}),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]})]})]})}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",disabled:g,className:"inline-flex w-full justify-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 sm:ml-3 sm:w-auto",children:g?"Guardando...":"Guardar"}),e.jsx("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:l,children:"Cancelar"})]})]})})})})})]})})}function S({categories:u}){const[l,d]=n.useState(u),[a,o]=n.useState(null),[g,c]=n.useState(!1),[r,i]=n.useState({name:"",description:""}),m=t=>{d([...l,t])},p=t=>{o(t.id),i({name:t.name,description:t.description||""})},j=()=>{o(null),i({name:"",description:""})},v=async t=>{try{const{error:s}=await y.from("categories").update({name:r.name,description:r.description,updated_at:new Date().toISOString()}).eq("id",t);if(s)throw s;d(l.map(x=>x.id===t?{...x,...r,updated_at:new Date().toISOString()}:x)),o(null)}catch(s){console.error("Error updating category:",s),alert("Error al actualizar la categoría")}},b=async t=>{if(confirm("¿Estás seguro de que quieres eliminar esta categoría?"))try{const{error:s}=await y.from("categories").delete().eq("id",t);if(s)throw s;d(l.filter(x=>x.id!==t))}catch(s){console.error("Error deleting category:",s),alert("Error al eliminar la categoría")}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"sm:flex sm:items-center",children:[e.jsx("div",{className:"sm:flex-auto",children:e.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"Lista de todas las categorías disponibles en el menú."})}),e.jsx("div",{className:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none",children:e.jsx("button",{type:"button",onClick:()=>c(!0),className:"block rounded-md bg-indigo-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:"Agregar categoría"})})]}),e.jsx("div",{className:"mt-8 flow-root",children:e.jsx("div",{className:"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8",children:e.jsx("div",{className:"inline-block min-w-full py-2 align-middle",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-0",children:"Nombre"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Descripción"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Última actualización"}),e.jsx("th",{scope:"col",className:"relative py-3.5 pl-3 pr-4 sm:pr-0",children:e.jsx("span",{className:"sr-only",children:"Acciones"})})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:l.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-0",children:a===t.id?e.jsx("input",{type:"text",value:r.name,onChange:s=>i({...r,name:s.target.value}),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"}):t.name}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:a===t.id?e.jsx("input",{type:"text",value:r.description,onChange:s=>i({...r,description:s.target.value}),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"}):t.description||"-"}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:new Date(t.updated_at).toLocaleDateString()}),e.jsx("td",{className:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-0",children:a===t.id?e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{onClick:()=>v(t.id),className:"text-indigo-600 hover:text-indigo-900",children:"Guardar"}),e.jsx("button",{onClick:j,className:"text-gray-600 hover:text-gray-900",children:"Cancelar"})]}):e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{onClick:()=>p(t),className:"text-indigo-600 hover:text-indigo-900",children:"Editar"}),e.jsx("button",{onClick:()=>b(t.id),className:"text-red-600 hover:text-red-900",children:"Eliminar"})]})})]},t.id))})]})})})}),e.jsx(w,{isOpen:g,onClose:()=>c(!1),onCategoryAdded:m})]})}export{S as default};
